import time
import random

def maximumSum(a, q):
    d = {}
    rd = {}
    out = [0 for _ in a]
    out_sum = 0
    for i in q:
        # print(list(range(i[0],i[1]+1)))
        for j in range(i[0], i[1] + 1):
            if j not in d:
                d.setdefault(j, 1)
            else:
                d[j] += 1
    # print(d)
    for k, v in d.items():
        rd.setdefault(v, []).append(k)
    # print(rd)
    for k in reversed(sorted(rd.keys())):
        # print("k =", k)
        for ind in rd[k]:
            # print(ind)
            out[ind] = max(a)
            a.remove(max(a))
    # print(out)
    # print(a)
    for i in q:
        out_sum += sum(out[i[0]:i[1] + 1])
    return out_sum


# a = [9, 7, 2, 4, 4]
# q = [[1, 3], [1, 4], [0, 2]]
# print(maximumSum(a,q),"= 62")
# a = [2, 1, 2]
# q = [[0,1]]
# print(maximumSum(a,q),"= 4")
# a = [5, 3, 2]
# q = [[0,0], [0,1], [1,2], [0,2]]
# print(maximumSum(a,q),"= 28")
# a = [3, 99, 20, 7, 64, 23, 81, 98, 29, 91, 25, 93, 30, 80, 15, 58, 43, 95, 52, 91, 23, 49, 61, 22, 6, 62,
#      57, 15, 6, 16, 43, 8, 66, 20, 12, 90, 99, 70, 9, 44, 54, 93, 77, 25, 78, 77, 85, 31, 4, 96, 95,
#      55, 50, 38, 51, 30, 85, 27, 65, 74, 72, 18, 58, 37, 36, 50, 41, 73, 71, 41, 3, 67, 97, 84, 6, 71,
#      17, 94, 65, 83, 30, 77, 89, 30, 75, 50, 45, 38, 13, 7, 65, 13, 27, 11, 85, 25, 56, 19, 61, 58, 63,
#      30, 21, 44, 49, 99, 34, 93, 75, 66, 27, 71, 61, 47, 20, 65, 76, 98, 51, 98, 76, 62, 79, 1, 10, 36,
#      19, 3, 74, 14, 47, 41, 14, 87, 75, 76, 53, 45, 22, 12, 29, 34, 23, 50, 33, 74, 85, 78, 84, 89, 69,
#      82, 12, 28, 45, 4, 83, 11, 31, 49, 97, 93, 29, 90, 1, 31, 97, 7, 67, 57, 30, 47, 59, 48, 54, 29, 5,
#      97, 9, 75, 81, 79, 7, 74, 22, 8, 40, 0, 70, 62, 35, 29, 89, 77, 22, 59, 10, 95, 91, 26, 48, 76, 79,
#      41, 21, 9, 3, 13, 67, 48, 4, 21, 60, 72, 99, 29, 42, 63, 25, 89, 34, 99, 22, 35, 21, 61, 22, 19, 33,
#      40, 37, 94, 89, 36, 15, 98, 91, 61, 57, 44, 75, 83, 77, 75, 87, 45, 88, 12, 56, 15, 79, 0, 95, 25, 83, 26,
#      69, 3, 96, 48, 68, 55, 90, 19, 85, 63, 43, 87, 64, 58, 63, 43, 97, 92, 85, 40, 89, 28, 24, 95, 64, 57, 65,
#      60, 90, 89, 58, 22, 81, 86, 59, 21, 47, 63, 7, 73, 47, 19, 80, 82, 68, 5, 39, 98, 30, 40, 55, 25, 32, 75, 5,
#      37, 13, 81, 28, 5, 1, 3, 15, 13, 94, 68, 19, 5, 82, 78, 81, 31, 2, 31, 99, 81, 85, 77, 2, 86, 56, 39, 35, 51,
#      69, 96, 15, 29, 81, 57, 2, 26, 97, 61, 56, 1, 88, 39, 16, 79, 19, 29, 38, 16, 11, 85, 23, 45, 29, 54, 88, 7,
#      47, 59, 43, 57, 4, 7, 65, 69, 63, 25, 55, 15, 34, 13, 88, 57, 24, 25, 85, 26, 96, 67, 25, 89, 75, 49, 35, 5,
#      1, 17, 49, 61, 86, 5, 43, 15, 18, 44, 73, 26, 74, 53, 88, 9, 17, 30, 62, 50, 9, 51, 49, 45, 3, 83, 73, 3, 48,
#      95, 83, 48, 40, 92, 50, 60, 56, 72, 71, 7, 84, 52, 70, 83, 7, 12, 15, 83, 75, 11, 45, 37, 37, 9, 49, 22, 9, 68,
#      5, 50, 74, 62, 9, 41, 75, 34, 10, 4, 96, 90, 29, 2, 1, 87, 53, 13, 98, 22, 50, 51, 50, 11, 36, 10, 48, 62, 51,
#      73, 67, 5, 94, 11, 56, 41, 12, 20, 41, 46, 97, 21, 77, 74, 62, 11, 28, 86, 4, 67, 24, 65, 46, 49, 1, 60, 8, 30,
#      99, 62, 7, 49, 53, 6, 29, 64, 4, 74, 82, 15, 14, 76, 71, 56, 96, 79, 91, 63, 33, 75, 40, 55, 21, 39, 92, 46, 92,
#      79, 1, 13, 73, 52, 85, 46, 10, 8, 46, 41, 56, 48, 63, 53]
#
# q = [[86, 540], [12, 179], [98, 352], [37, 373], [65, 277], [86, 178], [64, 174], [2, 288], [57, 249], [26, 515],
#      [53, 257], [85, 249], [63, 339], [67, 446], [11, 415], [30, 531], [52, 53], [14, 98], [21, 109], [28, 167],
#      [0, 324], [92, 149], [95, 350], [16, 208], [84, 133], [13, 334], [75, 166], [48, 350], [39, 247], [22, 72],
#      [2, 54], [6, 424], [92, 50], [9, 419], [20, 296], [6, 536], [89, 180], [36, 152], [85, 269], [2, 34], [76, 381],
#      [0, 147], [34, 33], [95, 83], [18, 302], [27, 172], [51, 514], [18, 475], [66, 186], [27, 472], [14, 238],
#      [14, 124], [88, 311], [89, 298], [64, 139], [12, 109], [85, 443], [72, 215], [65, 418], [3, 422], [44, 220],
#      [75, 97], [22, 191], [75, 270], [29, 489], [39, 422], [78, 249], [59, 367], [24, 494], [47, 264]]
#
# print(maximumSum(a, q), "= 33")

# start_time = time.time()
# a = [random.randint(1, 10 ** 4) for i in range(10 **4)]
# print("--- %s seconds ---" % (time.time() - start_time))
# q = []
# for i in range(10**4):
#     l = random.randint(1, 1e4-100)
#     r = random.randint(l, 1e4-1)
#     q += [[l, r]]
# print("--- %s seconds ---" % (time.time() - start_time))
# start_time = time.time()
# print(maximumSum(a, q))
# print("--- %s seconds ---" % (time.time() - start_time))
# print(len(a),len(q))


'''
You are given an array of integers a. 
A range sum query is defined by a pair of non-negative integers l and r (l <= r). 
The output to a range sum query on the given array a is the sum of all the elements 
of a that have indices from l to r, inclusive.

You have the array a and a list of range sum queries q. 
Find an algorithm that can rearrange the array a in such a way that the total sum 
of all of the query outputs is maximized, and return this total sum.

Example

For a = [9, 7, 2, 4, 4] and q = [[1, 3], [1, 4], [0, 2]], the output should be
maximumSum(a, q) = 62.

You can get this sum if the array a is rearranged to be [2, 9, 7, 4, 4]. 
In that case, the first range sum query [1, 3] returns the sum 9 + 7 + 4 = 20, 
the second query [1, 4] returns the sum 9 + 7 + 4 + 4 = 24, 
and the third query [0, 2] returns the sum 2 + 9 + 7 = 18. 
The total sum will be 20 + 24 + 18 = 62.
'''
